{% extends "base.html" %}

{% block title %}Assistente Virtual - Change Life Academy{% endblock %}

{% block content %}
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark gym-navbar">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('dashboard') }}">
            <i class="bi bi-arrow-left"></i> Voltar ao √çnicio
        </a>
        <div class="navbar-nav ms-auto">
            <span class="navbar-text">
                <i class="bi bi-person-circle"></i> {{ user.name }}
            </span>
        </div>
    </div>
</nav>

<!-- Chatbot Content -->
<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="chatbot-container">
                <!-- Header -->
                <div class="chatbot-header">
                    <div class="chatbot-avatar">
                        <i class="bi bi-emoji-smile"></i>
                    </div>
                    <div class="chatbot-info">
                        <h4>Happy</h4>
                        <p>Assistente Virtual da Change Life Academy</p>
                    </div>
                </div>

                <!-- Chat Messages -->
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot-message">
                        <div class="message-content">
                            <i class="bi bi-emoji-smile"></i>
                            <div class="message-text">
                                <p>Ol√°, {{ user.name }}! üëã</p>
                                <p>Meu nome √© <strong>Happy</strong> e sou a assistente virtual da Change Life Academy! üòä</p>
                                <p>Estou aqui para te ajudar a conhecer nossa empresa e responder todas as suas d√∫vidas sobre nossa cultura, estrutura e benef√≠cios.</p>
                                <p>Fico muito feliz em te receber em nossa equipe! üéâ</p>
                                <p>Escolha uma das op√ß√µes abaixo para come√ßarmos nossa conversa:</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="message-content">
                        
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>

                <!-- Options -->
                <div class="chatbot-options">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('quem-somos')">
                                <span>Quem Somos</span>
                            </button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('missao-visao-valores')">
                                <span>Miss√£o, Vis√£o e Valores</span>
                            </button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('departamentos')">
                                <span>Departamentos</span>
                            </button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('beneficios')">
                                <span>Benef√≠cios</span>
                            </button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('estrutura-hierarquica')">
                                <span>Estrutura Hier√°rquica</span>
                            </button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <button class="btn chatbot-option" onclick="showInfo('feedbacks')">
                                <span>Feedbacks</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Back to Dashboard -->
                <div class="text-center mt-4">
                    <a href="{{ url_for('dashboard') }}" class="btn gym-btn">
                        <i class="bi bi-house"></i> Voltar ao √çnicio
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function showInfo(topic) {
    const messagesContainer = document.getElementById('chatbotMessages');
    const typingIndicator = document.getElementById('typingIndicator');
    
    // Remove active class from all options
    document.querySelectorAll('.chatbot-option').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Add active class to clicked option
    event.target.closest('.chatbot-option').classList.add('active');
    
    // Clear previous messages and show typing indicator
    messagesContainer.innerHTML = '';
    typingIndicator.style.display = 'block';
    
    // Scroll to bottom
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    // Simulate typing delay
    setTimeout(() => {
        typingIndicator.style.display = 'none';
        typeMessage(topic);
    }, 800);
}

function typeMessage(topic) {
    const messagesContainer = document.getElementById('chatbotMessages');
    let content = '';
    
    switch(topic) {
        case 'quem-somos':
            content = `
                <div class="message bot-message">
                    <div class="message-content">
                        <i class="bi bi-emoji-smile"></i>
                        <div class="message-text">
                            <h5><i class="bi bi-building"></i> Quem Somos</h5>
                            <p>Que legal que voc√™ quer nos conhecer melhor! üòä</p>
                            <p>A <strong>Change Life Academy</strong> √© uma empresa l√≠der no setor de fitness e bem-estar, fundada em 2010 com a miss√£o de transformar vidas atrav√©s da atividade f√≠sica.</p>
                            <p>Com mais de 10 anos de experi√™ncia, oferecemos servi√ßos de alta qualidade em:</p>
                            <ul>
                                <li>Muscula√ß√£o e condicionamento f√≠sico üí™</li>
                                <li>Aulas de grupo (Yoga, Pilates, Crossfit) üßò‚Äç‚ôÄÔ∏è</li>
                                <li>Personal training üèÉ‚Äç‚ôÇÔ∏è</li>
                                <li>Nutri√ß√£o esportiva ü•ó</li>
                                <li>Fisioterapia üè•</li>
                            </ul>
                            <p>Nossa equipe √© formada por profissionais altamente qualificados e apaixonados pelo que fazem. Eles s√£o o cora√ß√£o da nossa empresa! ‚ù§Ô∏è</p>
                        </div>
                    </div>
                </div>
            `;
            break;
            
        case 'missao-visao-valores':
            content = `
                <div class="message bot-message">
                    <div class="message-content">
                        
                        <div class="message-text">
                            <h5><i class="bi bi-eye"></i> Miss√£o, Vis√£o e Valores</h5>
                            <p>Essa √© uma das minhas partes favoritas para compartilhar! ‚ú®</p>
                            
                            <p><strong>üéØ Miss√£o</strong><br>
                            Transformar a vida das pessoas por meio da atividade f√≠sica e atendimento humanizado, com √™nfaze na performance, qualidade de vida, promovendo bem-estar e sa√∫de emocional üí™</p>
                            
                            <p><strong>üëÅÔ∏è Vis√£o</strong><br>
                            Ser reconhecida nacionalmente como a melhor academia em promo√ß√£o a sa√∫de mental, acolhimento social e uso de tecnologia de ponta, tornando-se referencia e alcan√ßando o maior indice de alunos fidelizados com meta em expans√£o nos pr√≥ximos 5 anos em diversas cidades üåü</p>
                            
                            <p><strong>‚ù§Ô∏è Valores</strong><br>
                            Muito mais que uma academia de ver√£o: um estilo de vida! colocamos nossos alunos no centro, prezando por um atendimento humano e emp√°tico. Promovemos mudan√ßas e melhorias para todos que buscam uma vida saud√°vel e equilibrada, buscando sempre as melhores tecnologias para proporcionar experiencias √∫nicas</p>
                        </div>
                    </div>
                </div>
            `;
            break;
            
        case 'departamentos':
            content = `
                <div class="message bot-message">
                    <div class="message-content">
                        
                        <div class="message-text">
                            <h5><i class="bi bi-diagram-3"></i> Departamentos</h5>
                            <p>Nossa empresa √© como uma grande fam√≠lia, e cada departamento tem seu papel especial! üë®‚Äçüë©‚Äçüëß‚Äçüë¶</p>
                            <div class="department-card">
                                <h6><i class="bi bi-people"></i> Recursos Humanos</h6>
                                <p>Nossa equipe de RH cuida de todos n√≥s com muito carinho! Eles s√£o respons√°veis pela gest√£o de pessoas, recrutamento, treinamentos e desenvolvimento profissional. üíº</p>
                            </div>
                            <div class="department-card">
                                <h6><i class="bi bi-cash-coin"></i> Financeiro</h6>
                                <p>Eles mant√™m tudo organizado financeiramente! Gest√£o financeira, controle de custos, faturamento e planejamento or√ßament√°rio. üí∞</p>
                            </div>
                            <div class="department-card">
                                <h6><i class="bi bi-person-badge"></i> Opera√ß√µes</h6>
                                <p>O cora√ß√£o da nossa academia! Coordena√ß√£o das atividades di√°rias, gest√£o de instrutores e supervis√£o das aulas. üèÉ‚Äç‚ôÄÔ∏è</p>
                            </div>
                            <div class="department-card">
                                <h6><i class="bi bi-megaphone"></i> Marketing</h6>
                                <p>Nossa equipe criativa! Comunica√ß√£o, divulga√ß√£o, eventos e relacionamento com clientes. Eles fazem a nossa voz ser ouvida! üì¢</p>
                            </div>
                            <div class="department-card">
                                <h6><i class="bi bi-gear"></i> Manuten√ß√£o</h6>
                                <p>Nossos her√≥is da limpeza! Manuten√ß√£o de equipamentos, limpeza e conserva√ß√£o das instala√ß√µes. Tudo sempre impec√°vel! üßπ</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            break;
            
        case 'beneficios':
            content = `
                <div class="message bot-message">
                    <div class="message-content">
                        
                        <div class="message-text">
                            <h5><i class="bi bi-gift"></i> Benef√≠cios</h5>
                            <p>Confira os benef√≠cios oferecidos aos nossos colaboradores:</p>
                            <ul>
                                <li>Acesso gratuito √† academia ou desconto especial em planos</li>
                                <li>Programas de sa√∫de e bem-estar (check-ups, acompanhamento nutricional, aulas exclusivas)</li>
                                <li>Descontos em parceiros (lojas de suplementos, spas, cl√≠nicas est√©ticas)</li>
                                <li>Desafio interno de metas fitness com premia√ß√µes</li>
                                <li>Aulas e workshops exclusivos com treinadores da academia</li>
                                <li>Vale-transporte</li>
                                <li>Vale-refei√ß√£o ou vale-alimenta√ß√£o (cart√£o flex√≠vel √© uma tend√™ncia)</li>
                                <li>Plano de sa√∫de (com coparticipa√ß√£o ou integral)</li>
                                <li>Plano odontol√≥gico</li>
                                <li>Aux√≠lio-creche (para pais e m√£es colaboradores)</li>
                                <li>Subs√≠dio para cursos externos e certifica√ß√µes na √°rea fitness</li>
                                <li>Plano de carreira estruturado</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            break;
            
        case 'estrutura-hierarquica':
            content = `
                <div class="message bot-message">
                    <div class="message-content">
                        
                        <div class="message-text">
                            <h5><i class="bi bi-diagram-2"></i> Estrutura Hier√°rquica</h5>
                            <p>Nossa estrutura √© bem organizada, mas sempre com muito respeito e carinho entre todos! ü§ó</p>
                            <div class="hierarchy-tree">
                                <div class="hierarchy-level ceo">
                                    <i class="bi bi-crown"></i>
                                    <span>Diretoria üëë</span>
                                </div>
                                <div class="hierarchy-level management">
                                    <i class="bi bi-person-badge"></i>
                                    <span>Gerentes de Departamento üë®‚Äçüíº</span>
                                </div>
                                <div class="hierarchy-level supervisors">
                                    <i class="bi bi-people"></i>
                                    <span>Supervisores üë•</span>
                                </div>
                                <div class="hierarchy-level coordinators">
                                    <i class="bi bi-person-check"></i>
                                    <span>Coordenadores üë®‚Äçüíª</span>
                                </div>
                                <div class="hierarchy-level staff">
                                    <i class="bi bi-person"></i>
                                    <span>Colaboradores üë®‚Äçüíº</span>
                                </div>
                            </div>
                            <div class="hierarchy-info">
                                <h6>Princ√≠pios da Nossa Estrutura:</h6>
                                <p>O que mais me orgulha √© como nossa empresa funciona:</p>
                                <ul>
                                    <li><strong>Horizontalidade:</strong> Comunica√ß√£o direta entre todos os n√≠veis - todos podem falar com todos! üí¨</li>
                                    <li><strong>Transpar√™ncia:</strong> Decis√µes compartilhadas e abertas - nada de segredos! üîç</li>
                                    <li><strong>Desenvolvimento:</strong> Oportunidades de crescimento para todos - crescemos juntos! üå±</li>
                                    <li><strong>Mentoria:</strong> L√≠deres como mentores de suas equipes - aprendemos uns com os outros! üéì</li>
                                </ul>
                                <p>√â uma estrutura que funciona com muito amor e respeito! ‚ù§Ô∏è</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            break;
    }
    
    // Create message container
    const messageDiv = document.createElement('div');
    messageDiv.className = 'message bot-message';
    messageDiv.innerHTML = content;
    messagesContainer.appendChild(messageDiv);
    
    // Type the content with effect
    typeWriter(messageDiv.querySelector('.message-text'), content);
}

function typeWriter(element, fullContent) {
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = fullContent;
    const fullText = tempDiv.textContent || tempDiv.innerText || '';
    
    element.innerHTML = '';
    element.classList.add('typing');
    
    let i = 0;
    let currentText = '';
    
    function typeChar() {
        if (i < fullText.length) {
            currentText += fullText.charAt(i);
            element.innerHTML = currentText;
            i++;
            
            // Variable typing speed for more natural feel
            const delay = Math.random() * 20 + 10; // 10-30ms
            setTimeout(typeChar, delay);
        } else {
            // After typing is complete, show the formatted content
            element.classList.remove('typing');
            element.innerHTML = tempDiv.innerHTML;
            
            // Scroll to bottom after content is fully loaded
            setTimeout(() => {
                const messagesContainer = document.getElementById('chatbotMessages');
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 100);
        }
    }
    
    // Start typing after a small delay
    setTimeout(typeChar, 100);
}
</script>
{% endblock %}
